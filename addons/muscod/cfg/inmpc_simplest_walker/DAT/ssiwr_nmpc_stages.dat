******************************************************************************
* MUSCOD-II example
*
* Implementation of simplest walker model.
*
* Copyright (C) 2015, Manuel Kudruss, IWR, Heidelberg
******************************************************************************

*  # of multiple shooting intervals on model stages
nshoot
0:  1 # feedback
1:  9 # transition
2:  1 # switch
3:  1 # limit feedback
4:  9 # limit
5:  1 # limit switch

*******************************************************************************
*  parameters start values, scale factors, and bounds

; from optimal solution
p
  0:   4.0000000000000001E-03
  1:   1.0000000000000000E-01
  2:  -3.0745767984375671E-02
  3:  -6.1491535968751350E-02
  4:   2.8416740742969078E-02
  5:   3.3669122180547137E-03

p
  0:   0.004
  1:   0.12
  2:   0.0 ; no initial slack
  3:   0.0 ; no initial slack
  4:   0.0 ; no initial slack
  5:   0.0 ; no initial slack

p_sca
ALL: 1.0

p_min
  0:  -1.0
  1:   0.0
  2:  -2.0
  3:  -2.0
  4:  -2.0
  5:  -2.0

p_max
  0:  1.0
  1:  0.0
  2:  2.0
  3:  2.0
  4:  2.0
  5:  2.0

p_fix
  0: 1
  1: 1
  2: 0
  3: 0
  4: 0
  5: 0

p_name
  0: ! slope
  1: ! v_ref
  2: slack0
  3: slack1
  4: slack2
  5: slack3

*******************************************************************************
*  model stage duration start values, scale factors, and bounds

; from optimal solution
h
  0:   2.0000000000000001E-01
  1:   3.4205256952057503E+00
  2:   0.0000000000000000E+00
  3:   2.0000000000000001E-01
  4:   3.0420794630031236E+00
  5:   0.0000000000000000E+00

h
  0:  0.2 # fixed to control rate
  1:  3.0
  2:  0.0
  3:  0.2
  4:  3.0
  5:  0.0

h_sca
ALL:  1.0

h_min
  0:  0.0
  1:  0.0
  2:  0.0
  3:  0.2
  4:  0.0
  5:  0.0

h_max
  0:  0.2
  1:  8.0
  2:  0.0
  3:  0.2
  4:  4.0
  5:  0.0

h_fix
  0:  0
  1:  0
  2:  1
  3:  0
  4:  0
  5:  1

h_name
  0: feedback
  1: transition
  2: ! double_support
  3: !feedback
  4: limit_cycle
  5: ! double_support

*******************************************************************************
*  differential state start values, scale factors, and bounds

* specification mode for state variable start values
* 0 : all values sd(*,*), sa(*,*) specified in data file
* 1 : linear interpolation
* 2 : start values given, all others generated by integration

s_spec
0

###############################################################################
# DAT FILE INITIALIZATION
###############################################################################

sd_min(0,0)  ! 0
  0:  0.153400
  1:  0.306800
  2: -0.156100
  3: -0.007300
  4:  0.0

sd_max(0,0)  ! 0
  0:  0.153400
  1:  0.306800
  2: -0.156100
  3: -0.007300
  4:  0.0

# ------------------------------------------------------------------------------

sd(0,0)  ! 0
  0:   1.5340000000000001E-01
  1:   3.0680000000000002E-01
  2:  -1.5609999999999999E-01
  3:  -7.3000000000000001E-03
  4:   0.0000000000000000E+00

sd(1,0)  ! 1
  0:   1.2496028738482753E-01
  1:   3.0214137390634510E-01
  2:  -1.2923581407326051E-01
  3:  -4.0196523530560892E-02
  4:   2.0000000000000001E-01

sd(1,1)  ! 2
  0:   8.3478892194053841E-02
  1:   2.7371671750137350E-01
  2:  -9.1661907284844649E-02
  3:  -1.1052173856943631E-01
  4:   5.8005841057841667E-01

sd(1,2)  ! 3
  0:   5.3602736036066627E-02
  1:   2.1931774045166255E-01
  2:  -6.7440806571028786E-02
  3:  -1.7440227667774624E-01
  4:   9.6011682115683339E-01

sd(1,3)  ! 4
  0:   3.0974585056962860E-02
  1:   1.4388949741058521E-01
  2:  -5.3065237492545665E-02
  3:  -2.1930084627434887E-01
  4:   1.3401752317352504E+00

sd(1,4)  ! 5
  0:   1.2289256954232962E-02
  1:   5.6256397887288784E-02
  2:  -4.6444016055411215E-02
  3:  -2.3752401737185733E-01
  4:   1.7202336423136675E+00

sd(1,5)  ! 6
  0:  -5.1842983402363664E-03
  1:  -3.2866053002685171E-02
  2:  -4.6612079111159131E-02
  3:  -2.2693095544422107E-01
  4:   2.1002920528920841E+00

sd(1,6)  ! 7
  0:  -2.4000463675457821E-02
  1:  -1.1307228078768750E-01
  2:  -5.3593934825781481E-02
  3:  -1.9127414595601255E-01
  4:   2.4803504634705011E+00

sd(1,7)  ! 8
  0:  -4.6909357552277590E-02
  1:  -1.7620555488062895E-01
  2:  -6.8407148660770536E-02
  3:  -1.3848191742670762E-01
  4:   2.8604088740489177E+00

sd(1,8)  ! 9
  0:  -7.7256997863210178E-02
  1:  -2.1797353264249955E-01
  2:  -9.3206236239456314E-02
  3:  -8.0731003458691220E-02
  4:   3.2404672846273352E+00

sd(2,0)  ! 10
  0:  -1.1946887803342265E-01
  1:  -2.3893775606680676E-01
  2:  -1.3158093399710272E-01
  3:  -3.1161903002904705E-02
  4:   3.6205256952057514E+00

sd(3,0)  ! 11
  0:   1.1946887803342265E-01
  1:   2.3893775606684531E-01
  2:  -1.2784270978958440E-01
  3:  -3.6320209773103517E-03
  4:   0.0000000000000000E+00

sd(4,0)  ! 12
  0:   9.6042453293362806E-02
  1:   2.3572330436460168E-01
  2:  -1.0719765924084035E-01
  3:  -2.9243952669782296E-02
  4:   2.0000000000000001E-01

sd(4,1)  ! 13
  0:   6.4417758113421902E-02
  1:   2.1716260216150904E-01
  2:  -8.1698833282292202E-02
  3:  -8.1438854473923350E-02
  4:   5.3800882922256932E-01

sd(4,2)  ! 14
  0:   3.9756944796295518E-02
  1:   1.8019230442653456E-01
  2:  -6.5604320937587488E-02
  3:  -1.3671005091846702E-01
  4:   8.7601765844513846E-01

sd(4,3)  ! 15
  0:   1.9219327519304556E-02
  1:   1.2528655502923522E-01
  2:  -5.7071248683526150E-02
  3:  -1.8628782998250784E-01
  4:   1.2140264876677078E+00

sd(4,4)  ! 16
  0:   4.3701128996514007E-04
  1:   5.5686612348210165E-02
  2:  -5.5119858222332715E-02
  3:  -2.2269584851408081E-01
  4:   1.5520353168902772E+00

sd(4,5)  ! 17
  0:  -1.8756253035508926E-02
  1:  -2.3181140702966258E-02
  2:  -5.9525864436335216E-02
  3:  -2.4061026115822345E-01
  4:   1.8900441461128465E+00

sd(4,6)  ! 18
  0:  -4.0573941945018101E-02
  1:  -1.0457180899804533E-01
  2:  -7.0795558706056680E-02
  3:  -2.3765332502852538E-01
  4:   2.2280529753354159E+00

sd(4,7)  ! 19
  0:  -6.7530868618155451E-02
  1:  -1.8152021011511354E-01
  2:  -9.0221879614117373E-02
  3:  -2.1494167874488812E-01
  4:   2.5660618045579855E+00

sd(4,8)  ! 20
  0:  -1.0273040280361258E-01
  1:  -2.4805884527489144E-01
  2:  -1.2002530161376794E-01
  3:  -1.7724240533166491E-01
  4:   2.9040706337805546E+00

sd(5,0)  ! 21
  0:  -1.5021464601779833E-01
  1:  -3.0042929203559599E-01
  2:  -1.6358656874793795E-01
  3:  -1.3280512371260178E-01
  4:   3.2420794630031238E+00

sd(5,1)  ! 22
  0:   1.5021464601779833E-01
  1:   3.0042929203559665E-01
  2:  -1.5625945053255347E-01
  3:  -6.9989331953650659E-03
  4:   0.0000000000000000E+00


u(0,0)  ! 0
  0:  -7.3181772365119501E-03

ue(0)  ! 1-
  0:  -7.3181772365119501E-03

u(1,0)  ! 1
  0:  -2.6923486227473457E-03

u(1,1)  ! 2
  0:   1.2089060284534879E-02

u(1,2)  ! 3
  0:   2.5208334453829338E-02

u(1,3)  ! 4
  0:   3.4813244258089772E-02

u(1,4)  ! 5
  0:   3.9645233163234955E-02

u(1,5)  ! 6
  0:   3.8377712010515430E-02

u(1,6)  ! 7
  0:   3.2771310580423166E-02

u(1,7)  ! 8
  0:   2.1320943774572183E-02

u(1,8)  ! 9
  0:   7.4345782070312141E-03

ue(1)  ! 10-
  0:   7.4345782070312141E-03

u(2,0)  ! 10
  0:  -7.2743634218776002E-07

ue(2)  ! 11-
  0:  -7.2743634218776002E-07

u(3,0)  ! 11
  0:  -2.6592341178400413E-04

ue(3)  ! 12-
  0:  -2.6592341178400413E-04

u(4,0)  ! 12
  0:  -6.5650678503253812E-03

u(4,1)  ! 13
  0:  -1.3548381257701626E-02

u(4,2)  ! 14
  0:  -1.9037183255704800E-02

u(4,3)  ! 15
  0:  -2.2405131270375848E-02

u(4,4)  ! 16
  0:  -2.3262433879021608E-02

u(4,5)  ! 17
  0:  -2.1491345635488567E-02

u(4,6)  ! 18
  0:  -1.7308177948460603E-02

u(4,7)  ! 19
  0:  -1.1203023714535741E-02

u(4,8)  ! 20
  0:  -3.8724332109646292E-03

ue(4)  ! 21-
  0:  -3.8724332109646292E-03

u(5,0)  ! 21
  0:  -1.1919570891710870E-06

ue(5)  ! 22-
  0:  -1.1919570891710870E-06

###############################################################################

sd_sca(*,*)
ALL: 1.0

sd(*,*)
 0: 0.0
 1: 0.0
 2: 0.0
 3: 0.0

sd_min(*,*)
 0: -100.0
 1: -100.0
 2: -100.0
 3: -100.0
 4:    0.0

sd_max(*,*)
 0:  100.0
 1:  100.0
 2:  100.0
 3:  100.0
 4:  100.0

xd_name
 0: phi_st
 1: phi_h
 2: dphi_st
 3: dphi_h
 4: time

*******************************************************************************
*  control parameterization types

u_type(*)
ALL: 0

*******************************************************************************
*  control start values, scale factors, and bounds

u(*,*)
 0: 0.0

u_sca(*,*)
 0: 1.0

u_min(*,*)
 0: -10.0

u_max(*,*)
 0:  10.0

u_fix(*,*)
 0:  0

u_name
 0: hip_actuation

*******************************************************************************
* decoupled i.p.c. scale factors

rd_sca(0,s)
ALL: 1.0

rd_sca(0,i)
ALL: 1.0

rd_sca(0,e)
ALL: 1.0

*******************************************************************************
* coupled i.p.c. scale factors

rc_sca
ALL: 1.0

*******************************************************************************
*  objective scale and expected range

of_sca
1.0

of_min
-1000000.0

of_max
1000000.0

of_name
objective

nhist
30

*******************************************************************************
* Choosing libraries *

libmodel
libssiwr_nmpc_stages

libhessian
hess_gaussnewton
hess_update

libsolve
solve_fullstep
solve_slse

libcond
cond_min

libtchk
tchk

libmssqp
mssqp_standard

libeval
eval_ind

libind
0: ind_rkfswt
1: ind_rkfswt
2: ind_strans
3: ind_rkfswt
4: ind_rkfswt
5: ind_strans

libqps
qps_qpopt

libplot
plot_pgplot
plot_noplot

*******************************************************************************
* Setting algorithmic parameters *

options_acc
1e-6
options_ftol
-1.0
options_itol
-1.0
options_rfac
0.0
options_levmar
0.00000
options_qp_featol
1.0e-8
options_qp_relax
1.1
options_nhtopy
0
options_frstart
0
options_frmax
0
options_itmax
500
options_plevel_screen
0
options_plevel_file
-1
options_plevel_matlab
-1
options_bflag
-1
options_qp_itmax
10000
options_qp_expand
99999999
options_sflag
0
options_options_wflag
0
options_cflag
0
options_output_ps
0
options_output_gif
0
options_plot_stage_marker
1
options_iest_hess_plitt
0
*******************************************************************************
