******************************************************************************
* MUSCOD-II example
*
* Implementation of pendulum on a cart using RBDL
*
* Copyright (C) 2015, Manuel Kudruss, IWR, Heidelberg
******************************************************************************

*  # of multiple shooting intervals on model stages
nshoot
0: 60

* specification mode for state variable start values
* 0 : all values sd(*,*), sa(*,*) specified in data file
* 1 : linear interpolation
* 2 : start values given, all others generated by integration

s_spec
0

######################################################################
# DAT FILE INITIALIZATION
######################################################################

*
*  variables
*

p
  0:   0.0000000000000000E+00


h
  0:   3.0000000000000000E+00


sd(0,0)  ! 0
  0:   0.0000000000000000E+00
  1:   3.1400000000000001E+00
  2:   0.0000000000000000E+00
  3:   0.0000000000000000E+00

sd(0,1)  ! 1
  0:   1.8743841079349587E-02
  1:   3.1773721428095500E+00
  2:   7.4940931119203658E-01
  3:   1.4879571578816171E+00

sd(0,2)  ! 2
  0:   7.4855080215204511E-02
  1:   3.2873270886238890E+00
  2:   1.4934636719370900E+00
  3:   2.8868023541765933E+00

sd(0,3)  ! 3
  0:   1.6562800531129873E-01
  1:   3.4583817636468006E+00
  2:   2.1339345928862863E+00
  3:   3.9130145202439146E+00

sd(0,4)  ! 4
  0:   2.6895796619802859E-01
  1:   3.6387074639304848E+00
  2:   1.9984287364180966E+00
  3:   3.2746578732352147E+00

sd(0,5)  ! 5
  0:   3.5337781009822727E-01
  1:   3.7632304182451359E+00
  2:   1.3804727960073302E+00
  3:   1.7063059567313159E+00

sd(0,6)  ! 6
  0:   4.1451167536618255E-01
  1:   3.8211891407866854E+00
  2:   1.0656384527951430E+00
  3:   6.0941764150117095E-01

sd(0,7)  ! 7
  0:   4.4917694383609336E-01
  1:   3.8072977828363950E+00
  2:   3.2058805570581339E-01
  3:  -1.1660637205514541E+00

sd(0,8)  ! 8
  0:   4.4641749429210681E-01
  1:   3.7042132386374020E+00
  2:  -4.3345362165970680E-01
  3:  -2.9626694224681889E+00

sd(0,9)  ! 9
  0:   4.0554614981759718E-01
  1:   3.5106472358414353E+00
  2:  -1.2039564718671467E+00
  3:  -4.7788310881876495E+00

sd(0,10)  ! 10
  0:   3.2594473057467332E-01
  1:   3.2277003509314146E+00
  2:  -1.9778309820781224E+00
  3:  -6.5064126668791671E+00

sd(0,11)  ! 11
  0:   2.0846393856645090E-01
  1:   2.8660415886636699E+00
  2:  -2.7091913000790884E+00
  3:  -7.8690925304499331E+00

sd(0,12)  ! 12
  0:   5.9350198780620235E-02
  1:   2.4573267902565754E+00
  2:  -3.2393807666314616E+00
  3:  -8.3591233410361507E+00

sd(0,13)  ! 13
  0:  -9.5485303953998638E-02
  1:   2.0669121230675302E+00
  2:  -2.9555745742460755E+00
  3:  -7.2472336674709616E+00

sd(0,14)  ! 14
  0:  -2.2319215880058466E-01
  1:   1.7422029032343329E+00
  2:  -2.1620013500968311E+00
  3:  -5.8109692426569124E+00

sd(0,15)  ! 15
  0:  -3.1246909353708419E-01
  1:   1.4790610445663110E+00
  2:  -1.4152310785603692E+00
  3:  -4.7788861359235959E+00

sd(0,16)  ! 16
  0:  -3.6516898324075769E-01
  1:   1.2582370546968547E+00
  2:  -6.9583990282321662E-01
  3:  -4.1118854169743537E+00

sd(0,17)  ! 17
  0:  -3.8224027432317337E-01
  1:   1.0622947476798679E+00
  2:   1.2164470467451260E-02
  3:  -3.7802371836568258E+00

sd(0,18)  ! 18
  0:  -3.6394850051853800E-01
  1:   8.7479625580146736E-01
  2:   7.2032157076533687E-01
  3:  -3.7743496227278404E+00

sd(0,19)  ! 19
  0:  -3.1005897033515939E-01
  1:   6.7923773461526249E-01
  2:   1.4373711132175948E+00
  3:  -4.1064442151965856E+00

sd(0,20)  ! 20
  0:  -2.1995040273608496E-01
  1:   4.5801259629326457E-01
  2:   2.1699364271171593E+00
  3:  -4.8069900253367974E+00

sd(0,21)  ! 21
  0:  -1.2006875889261653E-01
  1:   2.4276590759940933E-01
  2:   1.8231314560538388E+00
  3:  -3.8233330239255467E+00

sd(0,22)  ! 22
  0:  -4.6370404398408997E-02
  1:   9.0414054876542499E-02
  2:   1.1241800981040007E+00
  3:  -2.2883248818510835E+00

sd(0,23)  ! 23
  0:  -8.9626108697572465E-03
  1:   1.4969222440244158E-02
  2:   3.7247459361693647E-01
  3:  -7.4154010136771586E-01

sd(0,24)  ! 24
  0:   6.3437234076080021E-05
  1:  -2.7696234961985060E-03
  2:  -1.1291291134817380E-02
  3:   2.8815472165876904E-02

sd(0,25)  ! 25
  0:  -3.0427831422202796E-04
  1:  -1.7805476983873845E-03
  2:  -3.4253877512051925E-03
  3:   1.0924836587880281E-02

sd(0,26)  ! 26
  0:  -5.5189334912777272E-04
  1:  -1.1203596351599693E-03
  2:  -6.4846044698374282E-03
  3:   1.5601282933587139E-02

sd(0,27)  ! 27
  0:  -7.9994899253937174E-04
  1:  -5.1446188093882744E-04
  2:  -3.4425605662187888E-03
  3:   8.7432944644917163E-03

sd(0,28)  ! 28
  0:  -9.0187632908971882E-04
  1:  -2.2735743264220372E-04
  2:  -6.3687150916607628E-04
  3:   2.7923331840182782E-03

sd(0,29)  ! 29
  0:  -9.6949295162337490E-04
  1:  -2.0356628702780035E-05
  2:  -2.0694845044523782E-03
  3:   5.5249044146942951E-03

sd(0,30)  ! 30
  0:  -9.4313196799837790E-04
  1:  -3.0796722366911941E-06
  2:   3.1237902589297821E-03
  3:  -4.8308871574739374E-03

sd(0,31)  ! 31
  0:  -8.7799008601088314E-04
  1:  -6.3840556573371401E-05
  2:  -5.1762433020166956E-04
  3:   2.3896569158707109E-03

sd(0,32)  ! 32
  0:  -8.8587426634948601E-04
  1:   1.8908476998218596E-05
  2:   2.0158288929021862E-04
  3:   9.3513736847738939E-04

sd(0,33)  ! 33
  0:  -8.6946019696329600E-04
  1:   5.3792624528990056E-05
  2:   4.5469555040895655E-04
  3:   4.6648386247668058E-04

sd(0,34)  ! 34
  0:  -8.3904313667853832E-04
  1:   6.3205320241279067E-05
  2:   7.6191044509221761E-04
  3:  -8.8294904746375304E-05

sd(0,35)  ! 35
  0:  -8.0772052799280675E-04
  1:   7.3912003932747323E-05
  2:   4.9090609862848292E-04
  3:   5.1849393896024796E-04

sd(0,36)  ! 36
  0:  -6.1048238993951002E-04
  1:  -2.4492754623949958E-04
  2:   7.4012311508083063E-03
  3:  -1.3329534191761607E-02

sd(0,37)  ! 37
  0:  -5.4968051596819892E-04
  1:  -3.0185233136763312E-04
  2:  -4.9687090631136011E-03
  3:   1.1042706035143771E-02

sd(0,38)  ! 38
  0:  -6.5712948361056935E-04
  1:  -3.5749358644680536E-05
  2:   6.6858701278849823E-04
  3:  -3.5099322645498369E-04

sd(0,39)  ! 39
  0:  -6.2565417460724577E-04
  1:  -5.0399160467850931E-05
  2:   5.9054481396776009E-04
  3:  -2.3762711980509219E-04

sd(0,40)  ! 40
  0:  -6.4165603725146417E-04
  1:   2.7811257302170986E-05
  2:  -1.2312601403599360E-03
  3:   3.3801416439497847E-03

sd(0,41)  ! 41
  0:  -6.9522162110324652E-04
  1:   1.8282836628917494E-04
  2:  -9.1262783227908588E-04
  3:   2.8483643245877984E-03

sd(0,42)  ! 42
  0:  -7.7807906797664405E-04
  1:   4.0567249116735124E-04
  2:  -2.4034908521621298E-03
  3:   6.1054586283794425E-03

sd(0,43)  ! 43
  0:  -6.4699445828809835E-04
  1:   2.1886607946451858E-04
  2:   7.6484137749845355E-03
  3:  -1.3611562256481718E-02

sd(0,44)  ! 44
  0:  -5.2762620348959562E-04
  1:   6.6353263964416046E-05
  2:  -2.8724540824260352E-03
  3:   7.4840007748858475E-03

sd(0,45)  ! 45
  0:  -4.9549142638086901E-04
  1:   9.2303431785384561E-05
  2:   4.1576433343658977E-03
  3:  -6.4415541368464824E-03

sd(0,46)  ! 46
  0:  -3.5898217501865174E-04
  1:  -8.6812320709443345E-05
  2:   1.3041843118525660E-03
  3:  -7.5514295809393263E-04

sd(0,47)  ! 47
  0:  -2.8916213285123759E-04
  1:  -1.3627607001556695E-04
  2:   1.4890213586685329E-03
  3:  -1.2322946545994481E-03

sd(0,48)  ! 48
  0:  -2.3397930220046248E-04
  1:  -1.6305776309193833E-04
  2:   7.1850942451658724E-04
  3:   1.5624067267845212E-04

sd(0,49)  ! 49
  0:  -2.0936273873890245E-04
  1:  -1.3648679640688690E-04
  2:   2.6593574419912276E-04
  3:   9.1138010098636417E-04

sd(0,50)  ! 50
  0:  -2.3871949142835426E-04
  1:  -8.2496436752470430E-06
  2:  -1.4412546943042550E-03
  3:   4.2411805345813399E-03

sd(0,51)  ! 51
  0:  -2.1471371454760390E-04
  1:   1.2422439935875273E-05
  2:   2.4013225424039946E-03
  3:  -3.4107061893902937E-03

sd(0,52)  ! 52
  0:  -1.4199360462617292E-04
  1:  -6.4125928992828072E-05
  2:   5.0810384498492956E-04
  3:   3.3508768175175181E-04

sd(0,53)  ! 53
  0:  -1.1355928444509992E-04
  1:  -5.4896330584157831E-05
  2:   6.2919385852855381E-04
  3:   3.5748525954930403E-05

sd(0,54)  ! 54
  0:  -8.7861087530737166E-05
  1:  -4.2876012969811125E-05
  2:   3.9863563371098207E-04
  3:   4.4722863112892384E-04

sd(0,55)  ! 55
  0:  -6.4811451889722297E-05
  1:  -2.7648299129060196E-05
  2:   5.2322572938496258E-04
  3:   1.6460928770952691E-04

sd(0,56)  ! 56
  0:  -3.6790789620559231E-05
  1:  -2.3765159650405208E-05
  2:   5.9756919718751116E-04
  3:  -8.5892962260605694E-06

sd(0,57)  ! 57
  0:  -1.2159475131819305E-05
  1:  -1.4246198128327486E-05
  2:   3.8760541860464575E-04
  3:   3.9106295961542647E-04

sd(0,58)  ! 58
  0:   1.0362822328813955E-05
  1:  -1.1933152902700581E-06
  2:   5.1318014742031621E-04
  3:   1.3339166771473106E-04

sd(0,59)  ! 59
  0:   3.4982781214703168E-05
  1:   7.5881414014066859E-06
  2:   4.7154648654716761E-04
  3:   2.1944447225590158E-04

sd(0,60)  ! 60
  0:   5.9475738331910139E-05
  1:   1.6998417107917303E-05
  2:   5.0809505014027569E-04
  3:   1.5865501201195784E-04

u(0,0)  ! 0
  0:   1.5000000000000000E+02

u(0,1)  ! 1
  0:   1.5000000000000000E+02

u(0,2)  ! 2
  0:   1.3228256176649245E+02

u(0,3)  ! 3
  0:  -2.1411244445887874E+01

u(0,4)  ! 4
  0:  -1.2103830242661439E+02

u(0,5)  ! 5
  0:  -6.0132764815064085E+01

u(0,6)  ! 6
  0:  -1.5000000000000000E+02

u(0,7)  ! 7
  0:  -1.5000000000000000E+02

u(0,8)  ! 8
  0:  -1.5000000000000000E+02

u(0,9)  ! 9
  0:  -1.5000000000000000E+02

u(0,10)  ! 10
  0:  -1.5000000000000000E+02

u(0,11)  ! 11
  0:  -1.2759057157064986E+02

u(0,12)  ! 12
  0:   3.2161703516545465E+01

u(0,13)  ! 13
  0:   1.5000000000000000E+02

u(0,14)  ! 14
  0:   1.5000000000000000E+02

u(0,15)  ! 15
  0:   1.5000000000000000E+02

u(0,16)  ! 16
  0:   1.5000000000000000E+02

u(0,17)  ! 17
  0:   1.5000000000000000E+02

u(0,18)  ! 18
  0:   1.5000000000000000E+02

u(0,19)  ! 19
  0:   1.4999914929764063E+02

u(0,20)  ! 20
  0:  -7.0293817653429528E+01

u(0,21)  ! 21
  0:  -1.3944687182335525E+02

u(0,22)  ! 22
  0:  -1.5000000000000000E+02

u(0,23)  ! 23
  0:  -7.6725770737353628E+01

u(0,24)  ! 24
  0:   1.5515933206008934E+00

u(0,25)  ! 25
  0:  -6.2626313938274081E-01

u(0,26)  ! 26
  0:   6.0066986054415594E-01

u(0,27)  ! 27
  0:   5.5774198882385251E-01

u(0,28)  ! 28
  0:  -2.8784914553590824E-01

u(0,29)  ! 29
  0:   1.0389625321547145E+00

u(0,30)  ! 30
  0:  -7.2890576834443999E-01

u(0,31)  ! 31
  0:   1.4368039282788830E-01

u(0,32)  ! 32
  0:   5.0998250365437023E-02

u(0,33)  ! 33
  0:   6.2039489173379973E-02

u(0,34)  ! 34
  0:  -5.3553067797641053E-02

u(0,35)  ! 35
  0:   1.3817912342836143E+00

u(0,36)  ! 36
  0:  -2.4776644537470509E+00

u(0,37)  ! 37
  0:   1.1262681491082760E+00

u(0,38)  ! 38
  0:  -1.6035622674171121E-02

u(0,39)  ! 39
  0:  -3.6461940283936717E-01

u(0,40)  ! 40
  0:   6.4781334109838148E-02

u(0,41)  ! 41
  0:  -2.9541892583581386E-01

u(0,42)  ! 42
  0:   2.0142488171191348E+00

u(0,43)  ! 43
  0:  -2.1036352997522001E+00

u(0,44)  ! 44
  0:   1.4073658832239140E+00

u(0,45)  ! 45
  0:  -5.7089687326348948E-01

u(0,46)  ! 46
  0:   3.5892633434561241E-02

u(0,47)  ! 47
  0:  -1.5562727257985737E-01

u(0,48)  ! 48
  0:  -9.2014815419941817E-02

u(0,49)  ! 49
  0:  -3.4228389204812776E-01

u(0,50)  ! 50
  0:   7.6884812483897302E-01

u(0,51)  ! 51
  0:  -3.7905017469158520E-01

u(0,52)  ! 52
  0:   2.3646411442448449E-02

u(0,53)  ! 53
  0:  -4.6608008417113836E-02

u(0,54)  ! 54
  0:   2.4583627646796613E-02

u(0,55)  ! 55
  0:   1.4623577069712143E-02

u(0,56)  ! 56
  0:  -4.2195508729787293E-02

u(0,57)  ! 57
  0:   2.5049727422330068E-02

u(0,58)  ! 58
  0:  -8.2988773466613503E-03

u(0,59)  ! 59
  0:   7.4327893879448329E-03

ue(0)  ! 60-
  0:   7.4327893879448329E-03

######################################################################

h
  0:   2.0

h_fix
  0: 1

u(*,*)
 0: 0.0

sd(0,0)
0:  0.0
1:  3.14
2:  0.0
3:  0.0

sd_min(0,0)
0:  0.0
1:  3.14
2:  0.0
3:  0.0

sd_max(0,0)
0:  0.0
1:  3.14
2:  0.0
3:  0.0

sd(*,*)
 0: 0.0
 1: 0.0
 2: 0.0
 3: 0.0

######################################################################

*  model stage duration start values, scale factors, and bounds

h
  0:   2.0

h_sca
ALL: 1.0

h_min
  0:   1.0

h_max
  0:   20.0

h_fix
  0: 1

h_name
  0: swing_phase

*  parameters start values, scale factors, and bounds

p
  0:   0.0

p_sca
ALL: 1.0

p_min
  0:   0.0

p_max
  0:   0.0

p_fix
  0: 0

p_name
  0: real_time

*  differential state start values, scale factors, and bounds

sd_sca(*,*)
ALL: 1.0

sd(*,*)
 0: 0.0
 1: 0.0
 2: 0.0
 3: 0.0

sd_min(*,*)
 0: -100.0
 1: -100.0
 2: -100.0
 3: -100.0

sd_max(*,*)
 0:  100.0
 1:  100.0
 2:  100.0
 3:  100.0

xd_name
 0: CartX
 1: PendPhi
 2: CartXDot
 3: PendPhiDot

*  control parameterization types
u_type(*)
ALL: 0

*  control start values, scale factors, and bounds
u(*,*)
 0: 0.0

u_sca(*,*)
 0: 1.0

u_min(*,*)
 0: -150.0

u_max(*,*)
 0:  150.0

udot_min(*,*)
 0: -50.0

udot_max(*,*)
 0:  50.0

u_name
 0: CartXAcc

*  decoupled i.p.c. scale factors
rd_sca(0,s)
ALL: 1.0

*rd_sca(0,i)
*ALL: 1.0

rd_sca(0,e)
ALL: 1.0

*rc_sca
*ALL: 1.0

of_name
!

*  objective scale and expected range; # of values in history plot
of_sca
1.0

of_min
0.0

of_max
40.0

nhist
30

**********************
* Choosing libraries *
**********************
libmodel
libnmpc_cartpole

libhessian
hess_gaussnewton
*hess_limitedmemoryupdate
*hess_update

libsolve
solve_fullstep
*solve_slse

libcond
cond_min
*cond_std

libtchk
tchk

libmssqp
mssqp_standard

libeval
eval_ind

libind
0: ind_rkf45

libqps
qps_qpopt

libplot
plot_pgplot
*plot_noplot
*plot_pgplot

**********************************
* Setting algorithmic parameters *
**********************************

options_acc
1e-5
options_ftol
-1.0
options_itol
-1.0
options_rfac
0.0
options_levmar
0.0
options_qp_featol
1.0e-8
options_qp_relax
1.1
options_nhtopy
0
options_frstart
0
options_frmax
0
options_itmax
1000
options_plevel_screen
0
options_plevel_file
0
options_plevel_matlab
0
options_bflag
-1
options_qp_itmax
10000
options_qp_expand
99999999
options_sflag
0
options_options_wflag
0
options_cflag
0
options_output_ps
0
options_output_gif
0
options_plot_stage_marker
1
options_iest_hess_plitt
1
